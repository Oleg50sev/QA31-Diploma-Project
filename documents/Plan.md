# План автоматизированного тестирования сервиса покупки туров через интернет-банк.
## Перечень автоматизируемых сценариев.
**Валидными данными при заполнении полей ввода следует считать:**
1. **«Номер карты»:** 16 цифр в формате **** **** **** ****.
2. **«Месяц»:** номер месяца в формате двух цифр 01-12, но не ранее текущего месяца в случае, если указан текущий год (использовать «06»).
3. **«Год»:** последние две цифры порядкового номера года, не ранее текущего года, не более 5-ти лет от текущего года (использовать «24»).
4. **«Владелец»:** Фамилия и Имя через пробел на латинице (использовать «Ivanov Oleg»).
5. **«CVC/CVV»:** три цифры (использовать «059»). Не допускается ввод в поле меньше или больше трёх цифр.
      
**Номера карт, используемых для тестирования:**

• 4444 4444 4444 4441, статус APPROVED

• 4444 4444 4444 4442, статус DECLINED

**Тестируемые БД:**

• MySql

• PostgreSQL
      
## UI тесты.

#### Предусловия:
Покупка тура через приложение веб-сервиса возможно двумя способами:
1. Обычная оплата по дебетовой карте: открыть главную страницу веб-сервиса и нажать кнопку «Купить».

2. Оплата путём выдачи кредита по данным банковской карты: открыть главную страницу веб-сервиса и нажать кнопку «Купить в кредит».

Во всех тестах необходимо использовать оба способа покупки тура (захода на страницу формы оплаты) согласно указанным предусловиям!

### Позитивные сценарии:
**Сценарий 1. Карта со статусом APPROVED, все поля формы покупки валидные.**

Заполнить поле "Номер карты" валидным номером карты 4444 4444 4444 4441 (статус APPROVED), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы выполнена успешно, сообщение «Успешно. Операция одобрена банком».


**Сценарий 2. Карта со статусом DECLINED, все поля формы покупки валидные.**

Заполнить поле "Номер карты" валидным номером карты 4444 4444 4444 4442 (статус DECLINED), остальные поля – валидными данными . Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы выполнена успешно, сообщение «Ошибка!  Банк отказал в проведении операции.».

### Негативные сценарии:
### Поле «Номер карты»
**Сценарий 3. Поле "Номер карты" пустое.**

Оставить поле "Номер карты" пустым, остальные поля заполнить валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Поле обязательно для заполнения».

**Сценарий 4. Поле "Номер карты" из 15-ти цифр.**

Заполнить поле "Номер карты" невалидным граничным номером карты из 15-ти цифр (например, 4444 4444 4444 444), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы не возможна, сообщение «неверный формат».

**Сценарий 5. Поле "Номер карты", которой нет в БД банка.**

Заполнить поле "Номер карты" валидным номером карты, которой нет в БД банка (например, 5555 4444 4444 444), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы возможна, сообщение «Ошибка!  Банк отказал в проведении операции.».

### Поле «Месяц»

**Сценарий 6. Поле "Месяц" пустое.**

Поле «Месяц» оставить пустым, остальные поля заполнить валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы не возможна, сообщение «Поле обязательно для заполнения».

**Сценарий 7. Поле "Месяц" 00.**

Заполнить поле «Месяц» невалидными граничными данными со значением меньше 1 (например: 00), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы не возможна, сообщение «Неверно указан срок действия карты».

**Сценарий 8. Поле "Месяц" 13.**

Заполнить поле «Месяц» невалидными граничными данными со значением более 12 (например: 13), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы не возможна, сообщение «Неверно указан срок действия карты».

**Сценарий 9. Поле "Месяц" 1.**

Заполнить поле «Месяц» невалидными данными из одной цифры (например: 1), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы не возможна, сообщение «неверный формат».

### Поле «Год»

**Сценарий 10. Поле "Год" пустое.**

Поле «Год» оставить пустым, остальные поля заполнить валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Поле обязательно для заполнения».

**Сценарий 11. Поле "Год" предшествующий текущему.**

Заполнить поле «Год» граничными невалидными данными года, предшествующего текущему (например: 21), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверно указан срок действия карты».

**Сценарий 12. Поле "Год", превышающий 5 лет от текущего.**

Заполнить поле «Год» граничными невалидными данными будущего года, превышающего 5 лет от текущего (например: 28), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверно указан срок действия карты».

**Сценарий 13. Поле "Год" неверного формата.**

Заполнить поле «Год» невалидными данными с неверным форматом года (например: 2), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверный формат».

### Поле «Владелец»

**Сценарий 14. Поле "Владелец" пустое.**

Поле «Владелец» оставить пустым, остальные поля заполнить валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Поле обязательно для заполнения».

**Сценарий 15. Поле "Владелец" одна фамилия на латинице.**

Заполнить поле «Владелец» только фамилией на латинице (например: Ivanov), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверный формат».

**Сценарий 16. Поле "Владелец" фамилия и имя на латинице в верхнем регистре.**

Заполнить поле «Владелец» валидными данными на латинице в верхнем регистре (например: IVANOV OLEG), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверный формат».

**Сценарий 17. Поле "Владелец" фамилия и имя на кирилице.**

Заполнить поле «Владелец» валидными на кириллице (например: Иванов Олег). Нажать кнопку «Продолжить», остальные поля – валидными данными. **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверный формат».

**Сценарий 18. Поле "Владелец" цифрами.**

Заполнить поле «Владелец» цифрами (например: 12345), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверный формат».

**Сценарий 19. Поле "Владелец" спецсимволами.**

Заполнить поле «Владелец» спецсимволами (например: @#<>/), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверный формат».

### Поле «CVC/CVV»

**Сценарий 20. Поле "CVC/CVV" пустое.**

Поле «CVC/CVV» оставить пустым, остальные поля заполнить валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Поле обязательно для заполнения».

**Сценарий 21. Поле "CVC/CVV" одна цифра.**

Заполнить поле «CVC/CVV» одной цифрой (например: 0), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы не возможна, сообщение «Неверный формат».

**Сценарий 22. Поле "CVC/CVV" две цифры.**

Заполнить поле «CVC/CVV» двумя цифрами (например: 05), остальные поля – валидными данными. Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, сообщение «Неверный формат».


**Сценарий 23. Отправка пустой формы оплаты.**

Очистить поля формы «Номер карты», «Месяц», «Год», «Владелец», «CVC/CVV». Нажать кнопку «Продолжить». **Ожидаемый результат:** отправка формы невозможна, во всех полях сообщение «Поле обязательно для заполнения».

## API-тесты

Необходимо убедиться, что при попытке обратиться к приложению через API сервис оплаты туров отдает те же данные, что и при UI-тестах. Для этого необходимы тесты, которые проверяют разные карты и статус этих карт в БД при обращении напрямую к Payment Gate и Credit Gate.

#### Предусловия:

**Используем две валидные карты со статусами:**

• APPROVED ("Номер карты" = "4444 4444 4444 4441", "Месяц" = "06", "Год" = "24", "Владелец" = "Ivanov Oleg", "CVV" = "059").

• DECLINED ("Номер карты" = "4444 4444 4444 4442", "Месяц" = "06", "Год" = "24", "Владелец" = "Ivanov Oleg", "CVV" = "059").

**Сценарий 1.**

Отправляем данные карты 4444 4444 4444 4441 по
URL-адресу http://localhost:8080/api/v1/pay. **Ожидаемый результат:** ответ сервера: код 200, статус карты APPROVED.

**Сценарий 2.**

Отправляем данные карты 4444 4444 4444 4442 по URL-адресу http://localhost:8080/api/v1/pay. **Ожидаемый результат:** ответ сервера: код 200, статус карты DECLINED.

**Сценарий 3.**

Отправляем данные карты 4444 4444 4444 4441 по URL-адресу http://localhost:8080/api/v1/credit. **Ожидаемый результат:** ответ сервера: код 200, статус карты APPROVED.

**Сценарий 4.**

Отправляем данные карты 4444 4444 4444 4442 по URL-адресу http://localhost:8080/api/v1/credit. **Ожидаемый результат:** ответ сервера: код 200, статус карты DECLINED.

## Перечень используемых инструментов с обоснованием выбора
•	IntelliJ IDEA

Многофункциональная среда разработки, подходящая как новичку, так и профессионалу. IDEA — это мощнейший редактор кода, содержащий в себе много различных встроенных инструментов, интеграцию с системами контроля версий, "умное" автодополнение кода, возможность разработки на различных языках программирования и много другое.

•	Java 11

Язык программирования на котором будет написан проект. По статистике Java является одним из самых популярных языков программирования в мире, это широко распространенный и универсальный язык, на котором написано огромное множество сайтов, приложений и даже софта (для умных домов, например).

•	Gradle

Преимущества: быстрота сборки, гибкость самой системы, производительность, простота и минимум кода.

•	Git

Любому современному проекту будет необходима система контроля версий. В Git можно откатиться к предыдущей сборке, можно вести параллельную разработку через систему веток, есть интеграция с IDEA.

•	Rest-assured

Это Java-библиотека, которую можно использовать для тестирования REST-служб, основанных на HTTP.

•	JUnit-5

Тестовым фреймворком в нашем случае будет JUnit, т.к. это один из наиболее популярный тестовых фреймворков на данный момент и обладает всем нужным функционалом и аннотациями.

•	Selenide

Фреймворк для тестирования веб-приложений на основе Selenium WebDriver. Его плюсы, в основном, в удобстве — веб-драйвер "из коробки", сокращается время написания тестов и количество строк кода.

•	Lombok

Это полезный плагин, аннотации которого позволят сократить время написания кода и количество строк кода за счет автоматически генерируемых конструкторов, getter/setter и т.п.

•	AppVeyor (либо GitHub Action)

Распределённый веб-сервис непрерывной интеграции, предназначенный для сборки и тестирования программного обеспечения, расположенного на GitHub.

•	Docker

Через Docker развёртываются СУБД MySQL и PostgreSQL, которые поддерживает сервис покупки туров поддерживает именно эти две СУБД, а также Node.js для того, что запускать симуляцию сервисов банка.

•	Allure

Необходим для просмотра расширенного отчета о прохождении тестов. В нем заложен значительно больший функционал по сравнению со стандартным отчетом Gradle.

## Перечень и описание возможных рисков при автоматизации.
1.	Из-за отсутствия ТЗ и какой-либо документации сложно понять, как должно работать приложение и какое поведение системы нужно считать некорректным.
2.	Обязательно необходимо поднимать VPN для запуска тестов, что сейчас очень непросто сделать в РФ.
3.	Возможны проблемы из-за необходимости поддержки двух СУБД (MySQL, Postgres)
4.	Отсутствие test_id усложняет написание и поддержку тестов из-за сложности в нахождении css-селекторов.
5.	В AppVeyor часто возникает проблема установленных лимитов использования, из-за чего невозможно применить этот сервис непрерывной интеграции.

## Интервальная оценка с учётом рисков (в часах).

1.	Анализ задания и требований дипломного проекта – 8 часов.
2.	Разработка тест-плана – 16 часов.
3.	Поднятие VPN – 8 часов.
4.	Разработка авто-тестов – 80 часов.
5.	Прогон авто-тестов – 16 часов.
6.	Устранение замечаний дипломного руководителя, консультации – 56 часов.
7.	Написание баг-репортов – 24 часа;
8.	Подготовка отчетной документации о тестировании – 16 часов.

## План сдачи работ.

1.	Разработка авто-тестов – 4 июля 2022 г.
2.	Подготовка отчетов по итогам прогона тестов – 9 июля 2022 г.
3.	Подготовка отчета по итогам автоматизированного тестирования – 12 июля 2022 г.
